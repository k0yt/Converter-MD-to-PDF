# Защищенные мультисервисные телекоммуникационные системы

## № 1 Модель Харрисона-Руззо-Ульмана

### Задача 1. Построить матрицы и записать в виде команд сценарий атаки с помощью троянской программы в системах, функционирующих на основе модели Харрисона-Руззо-Ульмана (ХРУ)

> Дано: Пусть имеется два субъекта: 𝑠1 - доверенный пользователь, admin и 𝑠2 - рядовой пользователь, user; и два каталога 𝑜1 и 𝑜2, владельцами которых являются пользователи 𝑠1 и 𝑠2. В каталоге 𝑜1 имеется объект 𝑜3 с секретной информацией. Исходная матрица доступа имеет вид:
> |S |𝑜1| 𝑜2| 𝑜3|
> |---|---|---|---|
> |𝑠1| own, r, w, e| r, w, e | own, r, w, e|
> |𝑠2| | own, r, w, e | |

### Решение:

Атакующий 𝑠2 должен создать в своем каталоге o2 файл с трояном и дать права rwx пользователю 𝑠1 на этот файл. Далее ожидает запуска доверенным пользователем 𝑠1 ( или исп. команду sleep()) трояна из каталога o2. Главная цель убедить пользователя 𝑠1 запустить файл. Когда пользователь 𝑠1 запускает файл, троян скопирует секрет из o3 в o2, затем делегирует права доступа для атакующего 𝑠2, который теперь может работать с тем же уровнем доступа, что и 𝑠1. В итоге файл становится доступным для чтения 𝑠2, и атакующий может его прочитать из каталога o2.  

"""bash
Command "создать файл" (𝑠2, троян):
  if "write" ∈ [𝑠2, o2] then
    Создать объект троян;
    Ввести {"own", "read", "write", "execute"}
    в [𝑠2, троян];
    end if
  if {"read", "write"} ⊆ [𝑠1, o2] then
    Ввести {"read", "write", "execute"} в [𝑠1, троян];
    end if
  end command
"""

|S |𝑜1 (секрет)| 𝑜2(секрета нет)| 𝑜3(секрет)| 𝑜4 (троян)|
|---|---|---|---|---|
|𝑠1| own, r, w, e | r, w, e | own, r, w, e| r, w, e |
|𝑠2| |  own, r, w, e | | own, r, w, e|

"""bash
Command "запустить файл" (s1,троян): 
  if {"read","write","execute"} ⊆ [𝑠1,троян] then
    Создать субъект 𝑠(троян);
    Ввести { "read","write","execute"} в [𝑠(троян),o2]; 
    Ввести { "read","write","execute"} в [𝑠(троян),троян]; 
    end if
  if {"own", "read","write","execute"} ⊆ [𝑠1,o1] and {"own", "read","write","execute"} ⊆ [𝑠1,o3] then
    Ввести {"read","write","execute"} в [𝑠(троян),о1]; 
    Ввести {"read","write","execute"} в [𝑠(троян),o3]; 
    end if 
  end command
"""

|S |𝑜1 (секрет)| 𝑜2(секрета нет)| 𝑜3(секрет)| 𝑜4 (троян)|
|---|---|---|---|---|
|𝑠1| own, r, w, e | r, w, e | own, r, w, e| r, w, e |
|𝑠2| |  own, r, w, e | | own, r, w, e|
|𝑠(троян)| r, w, e | r, w, e | r, w, e| r, w, e |

"""bash
Command "скопировать файл 𝑜3 программой 𝑠(троян) в 𝑜2" (𝑠(троян),o3,o2): 
  if "read" ∈ [sтр,o3] and "write" ∈ [𝑠(троян),o2] then 
    Создать объект o';
    Ввести {"own", "read", "write", "execute"} в [𝑠(троян),o']; 
    Ввести "read" в [s2,o']; 
    Читать (𝑠(троян),o3); 
    Записать (𝑠(троян), о'); 
    end if
    Уничтожить субъект 𝑠(троян); 
  end command
"""

|S |𝑜1 (секрет)| 𝑜2(секрета нет)| 𝑜3(секрет)| 𝑜4 (троян)| 𝑜'= 𝑜3(секрет)|
|---|---|---|---|---|---|
|𝑠1| own, r, w, e | r, w, e | own, r, w, e| r, w, e | 
|𝑠2| |  own, r, w, e | | own, r, w, e| r

### Задача 2. Построить сценарий аналогичной атаки. Отобразить последовательности команд перехода и изменений матрицы доступа.

> Дано: Доверенный пользователь 𝑠1 в исходном состоянии имеет на каталог 𝑜2 только права чтения r. Исходная матрица доступа имеет вид:
> |S |𝑜1| 𝑜2| 𝑜3|
> |---|---|---|---|
> |𝑠1| own, r, w, e| r | own, r, w, e|
> |𝑠2| | own, r, w, e | |

### Решение:
